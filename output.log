nohup: ignoring input
======================================================================
Lorenz 96 System: Integrated Sensor + Control Optimization
======================================================================

======================================================================
STEP 1: OPTIMAL SENSOR PLACEMENT
======================================================================
Running uncontrolled simulation for sensor optimization...
  T = 10000.0, dt = 0.01, transient = 100.0
  Collected 1000001 samples
  Target: x_3 (index 2)

Optimizing 2 sensor locations via CMA-ES...
  Maximum iterations: 200
(25_w,50)-aCMA-ES (mu_w=14.0,w_1=14%) in dimension 2 (seed=42, Sat Nov 15 21:00:21 2025)
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
    1     50 -4.059676000668316e+00 1.0e+00 3.89e+00  4e+00  5e+00 0:05.8
    2    100 -4.059676000668316e+00 1.4e+00 7.40e+00  8e+00  1e+01 0:11.6
    3    150 -4.059676000668316e+00 2.1e+00 8.37e+00  8e+00  8e+00 0:17.3
    4    200 -4.059676000668316e+00 1.3e+00 7.44e+00  3e+00  7e+00 0:23.0
    5    250 -4.059676000668316e+00 2.0e+00 7.53e+00  2e+00  7e+00 0:28.7
    6    300 -4.059676000668316e+00 3.1e+00 7.15e+00  2e+00  6e+00 0:34.4
    7    350 -4.059676000668316e+00 3.9e+00 7.52e+00  2e+00  8e+00 0:40.1
    8    400 -4.059676000668316e+00 4.0e+00 8.81e+00  2e+00  1e+01 0:45.7
    9    450 -4.059676000668316e+00 4.3e+00 7.94e+00  2e+00  9e+00 0:51.4
   10    500 -4.059676000668316e+00 6.0e+00 6.95e+00  1e+00  7e+00 0:57.1

Sensor optimization complete!
  Mutual information: 4.059676 nats
  Optimal sensor indices:
    Sensor 1: x_3 (index 2)
    Sensor 2: x_33 (index 32)
======================================================================

Sensor results saved to: sensors_auto_2.npz

======================================================================
STEP 2: CONTROL POLICY OPTIMIZATION
======================================================================
System: N = 40, F = 15.0
Actuated indices: [2]
Sensed indices: [2, 32]
Polynomial order: 2
Target variable: x_3 (index 2)
Threshold: 0.0
Objective: Maximize P(x_3 > 0.0)
======================================================================

Policy has 7 parameters.

Starting CMA-ES optimization...

(4_w,9)-aCMA-ES (mu_w=2.8,w_1=49%) in dimension 7 (seed=42, Sat Nov 15 21:01:18 2025)
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
    1      9 -6.874331256687433e-01 1.0e+00 2.72e-01  3e-01  3e-01 1:02.2
  → Best P(x_target>0.0) = 0.687433, LB = 0.675277
    2     18 -6.891231087689124e-01 1.2e+00 2.74e-01  3e-01  3e-01 2:05.2
  → Best P(x_target>0.0) = 0.689123, LB = 0.677294
    3     27 -6.827531724682753e-01 1.3e+00 2.87e-01  3e-01  3e-01 3:07.4
  → Best P(x_target>0.0) = 0.682753, LB = 0.671877
    4     36 -6.890331096689033e-01 1.4e+00 3.12e-01  3e-01  3e-01 4:07.3
  → Best P(x_target>0.0) = 0.689033, LB = 0.676005
    5     45 -6.870131298687013e-01 1.5e+00 3.12e-01  3e-01  3e-01 5:06.5
  → Best P(x_target>0.0) = 0.687013, LB = 0.674916
    6     54 -6.902330976690233e-01 1.6e+00 2.91e-01  3e-01  3e-01 6:01.8
  → Best P(x_target>0.0) = 0.690233, LB = 0.678595
    7     63 -6.886831131688683e-01 1.6e+00 2.96e-01  3e-01  3e-01 6:58.8
  → Best P(x_target>0.0) = 0.688683, LB = 0.676781
    8     72 -6.870631293687063e-01 1.6e+00 2.93e-01  3e-01  3e-01 7:57.1
  → Best P(x_target>0.0) = 0.687063, LB = 0.675689
    9     81 -6.863431365686343e-01 1.8e+00 2.83e-01  2e-01  3e-01 8:54.9
  → Best P(x_target>0.0) = 0.686343, LB = 0.674978
   10     90 -6.902530974690253e-01 1.8e+00 2.68e-01  2e-01  3e-01 9:51.8
  → Best P(x_target>0.0) = 0.690253, LB = 0.678366
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
   11     99 -6.909830901690983e-01 1.7e+00 2.54e-01  2e-01  3e-01 10:48.0
  → Best P(x_target>0.0) = 0.690983, LB = 0.679277
   12    108 -6.904630953690463e-01 1.7e+00 2.24e-01  2e-01  2e-01 11:42.5
  → Best P(x_target>0.0) = 0.690463, LB = 0.678124
   13    117 -6.911430885691143e-01 1.6e+00 2.17e-01  2e-01  2e-01 12:37.0
  → Best P(x_target>0.0) = 0.691143, LB = 0.677794
   14    126 -6.856531434685653e-01 1.7e+00 2.05e-01  2e-01  2e-01 13:33.7
  → Best P(x_target>0.0) = 0.685653, LB = 0.674148
   15    135 -6.867131328686713e-01 1.7e+00 2.03e-01  2e-01  2e-01 14:32.3
  → Best P(x_target>0.0) = 0.686713, LB = 0.675641
   16    144 -6.892731072689273e-01 1.8e+00 1.91e-01  2e-01  2e-01 15:29.5
  → Best P(x_target>0.0) = 0.689273, LB = 0.677682
   17    153 -6.842931570684293e-01 1.8e+00 1.86e-01  2e-01  2e-01 16:25.7
  → Best P(x_target>0.0) = 0.684293, LB = 0.673280
   18    162 -6.938130618693813e-01 1.9e+00 2.01e-01  2e-01  2e-01 17:20.5
  → Best P(x_target>0.0) = 0.693813, LB = 0.681325
   19    171 -6.913630863691363e-01 2.0e+00 1.92e-01  2e-01  2e-01 18:17.7
  → Best P(x_target>0.0) = 0.691363, LB = 0.679900
   20    180 -6.913730862691373e-01 2.1e+00 1.91e-01  2e-01  2e-01 19:22.4
  → Best P(x_target>0.0) = 0.691373, LB = 0.678770
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
   21    189 -6.931530684693153e-01 2.1e+00 1.92e-01  2e-01  2e-01 20:16.9
  → Best P(x_target>0.0) = 0.693153, LB = 0.680544
   22    198 -6.903030969690304e-01 2.1e+00 1.85e-01  1e-01  2e-01 21:11.1
  → Best P(x_target>0.0) = 0.690303, LB = 0.677848
   23    207 -6.907130928690713e-01 2.0e+00 1.70e-01  1e-01  2e-01 22:11.1
  → Best P(x_target>0.0) = 0.690713, LB = 0.677805
   24    216 -6.900730992690073e-01 2.0e+00 1.62e-01  1e-01  2e-01 23:18.2
  → Best P(x_target>0.0) = 0.690073, LB = 0.677881
   25    225 -6.917430825691743e-01 2.1e+00 1.72e-01  1e-01  2e-01 24:16.3
  → Best P(x_target>0.0) = 0.691743, LB = 0.680014
   26    234 -6.875831241687583e-01 2.6e+00 1.76e-01  1e-01  2e-01 25:11.0
  → Best P(x_target>0.0) = 0.687583, LB = 0.674566
   27    243 -6.881831181688183e-01 2.7e+00 1.97e-01  2e-01  2e-01 26:05.3
  → Best P(x_target>0.0) = 0.688183, LB = 0.676140
   28    252 -6.860231397686023e-01 2.6e+00 2.01e-01  1e-01  2e-01 27:01.4
  → Best P(x_target>0.0) = 0.686023, LB = 0.673794
   29    261 -6.912530874691253e-01 2.9e+00 1.99e-01  1e-01  2e-01 27:56.0
  → Best P(x_target>0.0) = 0.691253, LB = 0.678499
   30    270 -6.864931350686493e-01 2.8e+00 1.87e-01  1e-01  2e-01 28:52.5
  → Best P(x_target>0.0) = 0.686493, LB = 0.674884
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
   31    279 -6.904730952690473e-01 3.0e+00 1.93e-01  1e-01  2e-01 29:50.4
  → Best P(x_target>0.0) = 0.690473, LB = 0.678531
   32    288 -6.790332096679034e-01 3.3e+00 2.26e-01  1e-01  2e-01 30:49.5
  → Best P(x_target>0.0) = 0.679033, LB = 0.668690
   33    297 -6.856931430685693e-01 3.2e+00 2.46e-01  2e-01  3e-01 31:44.2
  → Best P(x_target>0.0) = 0.685693, LB = 0.673655
   34    306 -6.857331426685733e-01 3.2e+00 2.56e-01  2e-01  3e-01 32:39.7
  → Best P(x_target>0.0) = 0.685733, LB = 0.673838
   35    315 -6.970630293697063e-01 3.3e+00 2.62e-01  2e-01  3e-01 33:36.2
  → Best P(x_target>0.0) = 0.697063, LB = 0.684597
   36    324 -6.945730542694573e-01 3.3e+00 2.30e-01  1e-01  3e-01 34:33.6
  → Best P(x_target>0.0) = 0.694573, LB = 0.682236
   37    333 -6.907530924690753e-01 3.4e+00 2.09e-01  1e-01  2e-01 35:29.0
  → Best P(x_target>0.0) = 0.690753, LB = 0.679195
   38    342 -6.894731052689473e-01 3.5e+00 2.06e-01  1e-01  2e-01 36:30.5
  → Best P(x_target>0.0) = 0.689473, LB = 0.676868
   39    351 -6.892231077689223e-01 3.7e+00 2.14e-01  1e-01  2e-01 37:33.8
  → Best P(x_target>0.0) = 0.689223, LB = 0.677695
   40    360 -6.875231247687523e-01 3.8e+00 2.13e-01  1e-01  2e-01 38:36.8
  → Best P(x_target>0.0) = 0.687523, LB = 0.675633
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
   41    369 -6.896031039689603e-01 4.2e+00 2.25e-01  1e-01  3e-01 39:38.9
  → Best P(x_target>0.0) = 0.689603, LB = 0.677604
   42    378 -6.873731262687374e-01 4.7e+00 2.34e-01  1e-01  3e-01 40:42.4
  → Best P(x_target>0.0) = 0.687373, LB = 0.675520
   43    387 -6.964930350696493e-01 5.2e+00 2.15e-01  1e-01  3e-01 41:45.5
  → Best P(x_target>0.0) = 0.696493, LB = 0.684028
   44    396 -6.872831271687283e-01 5.6e+00 2.20e-01  1e-01  3e-01 42:52.9
  → Best P(x_target>0.0) = 0.687283, LB = 0.675448
   45    405 -6.903730962690373e-01 6.0e+00 2.19e-01  1e-01  3e-01 44:03.6
  → Best P(x_target>0.0) = 0.690373, LB = 0.678481
   46    414 -6.965830341696583e-01 6.3e+00 2.39e-01  1e-01  3e-01 45:11.5
  → Best P(x_target>0.0) = 0.696583, LB = 0.682782
   47    423 -6.875031249687503e-01 6.4e+00 2.34e-01  1e-01  3e-01 46:17.5
  → Best P(x_target>0.0) = 0.687503, LB = 0.675946
   48    432 -6.917930820691793e-01 6.1e+00 2.33e-01  1e-01  3e-01 47:25.4
  → Best P(x_target>0.0) = 0.691793, LB = 0.678399
   49    441 -6.885931140688593e-01 5.8e+00 2.11e-01  1e-01  3e-01 48:31.3
  → Best P(x_target>0.0) = 0.688593, LB = 0.677174
   50    450 -6.846531534684653e-01 6.0e+00 2.02e-01  1e-01  2e-01 49:38.2
  → Best P(x_target>0.0) = 0.684653, LB = 0.673513
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
   51    459 -6.927530724692753e-01 6.0e+00 2.21e-01  1e-01  3e-01 50:44.4
  → Best P(x_target>0.0) = 0.692753, LB = 0.680296
   52    468 -6.867131328686713e-01 5.5e+00 2.81e-01  2e-01  3e-01 51:52.9
  → Best P(x_target>0.0) = 0.686713, LB = 0.674348
   53    477 -6.916430835691643e-01 5.2e+00 3.32e-01  2e-01  4e-01 52:58.0
  → Best P(x_target>0.0) = 0.691643, LB = 0.680065
   54    486 -6.910430895691043e-01 5.0e+00 3.86e-01  2e-01  4e-01 54:05.4
  → Best P(x_target>0.0) = 0.691043, LB = 0.679461
   55    495 -6.871331286687133e-01 4.8e+00 4.29e-01  2e-01  5e-01 55:11.9
  → Best P(x_target>0.0) = 0.687133, LB = 0.675553
   56    504 -7.017329826701733e-01 5.0e+00 4.50e-01  2e-01  5e-01 56:16.9
  → Best P(x_target>0.0) = 0.701733, LB = 0.687119
   57    513 -6.933830661693383e-01 5.1e+00 4.84e-01  3e-01  6e-01 57:28.4
  → Best P(x_target>0.0) = 0.693383, LB = 0.680884
   58    522 -6.885331146688534e-01 5.2e+00 4.65e-01  3e-01  6e-01 58:42.0
  → Best P(x_target>0.0) = 0.688533, LB = 0.676566
   59    531 -6.940130598694013e-01 5.1e+00 4.77e-01  3e-01  6e-01 59:48.7
  → Best P(x_target>0.0) = 0.694013, LB = 0.681590
   60    540 -6.981530184698153e-01 5.2e+00 4.64e-01  3e-01  6e-01 60:55.2
  → Best P(x_target>0.0) = 0.698153, LB = 0.685538
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
   61    549 -6.916230837691623e-01 5.3e+00 4.79e-01  3e-01  6e-01 62:02.3
  → Best P(x_target>0.0) = 0.691623, LB = 0.679562
   62    558 -6.856931430685693e-01 5.5e+00 4.46e-01  3e-01  5e-01 63:12.7
  → Best P(x_target>0.0) = 0.685693, LB = 0.672729
   63    567 -6.865631343686563e-01 5.6e+00 4.13e-01  2e-01  5e-01 64:13.6
  → Best P(x_target>0.0) = 0.686563, LB = 0.675009
   64    576 -6.877431225687743e-01 5.7e+00 4.82e-01  3e-01  6e-01 65:11.3
  → Best P(x_target>0.0) = 0.687743, LB = 0.675530
   65    585 -6.941330586694133e-01 5.7e+00 4.67e-01  3e-01  5e-01 66:07.5
  → Best P(x_target>0.0) = 0.694133, LB = 0.681560
   66    594 -6.918430815691843e-01 5.7e+00 4.73e-01  3e-01  6e-01 67:03.8
  → Best P(x_target>0.0) = 0.691843, LB = 0.678925
   67    603 -6.857531424685753e-01 5.4e+00 4.45e-01  2e-01  5e-01 67:59.5
  → Best P(x_target>0.0) = 0.685753, LB = 0.674507
   68    612 -6.945630543694563e-01 6.1e+00 4.78e-01  3e-01  6e-01 69:00.3
  → Best P(x_target>0.0) = 0.694563, LB = 0.682330
   69    621 -6.892931070689293e-01 6.5e+00 4.98e-01  3e-01  6e-01 70:08.5
  → Best P(x_target>0.0) = 0.689293, LB = 0.676920
   70    630 -6.843431565684344e-01 6.7e+00 5.44e-01  3e-01  8e-01 71:09.1
  → Best P(x_target>0.0) = 0.684343, LB = 0.673110
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
   71    639 -6.884431155688443e-01 7.3e+00 6.01e-01  3e-01  8e-01 72:07.5
  → Best P(x_target>0.0) = 0.688443, LB = 0.676528
   72    648 -6.861631383686163e-01 7.0e+00 6.46e-01  3e-01  9e-01 73:04.8
  → Best P(x_target>0.0) = 0.686163, LB = 0.674558
   73    657 -6.866331336686633e-01 7.3e+00 6.85e-01  3e-01  1e+00 74:02.4
  → Best P(x_target>0.0) = 0.686633, LB = 0.675021
   74    666 -6.848931510684894e-01 7.2e+00 6.53e-01  3e-01  9e-01 75:00.5
  → Best P(x_target>0.0) = 0.684893, LB = 0.673151
   75    675 -6.936930630693693e-01 7.2e+00 6.14e-01  3e-01  8e-01 75:56.0
  → Best P(x_target>0.0) = 0.693693, LB = 0.681142
   76    684 -6.899531004689953e-01 7.6e+00 6.50e-01  3e-01  9e-01 76:52.5
  → Best P(x_target>0.0) = 0.689953, LB = 0.677642
   77    693 -6.853131468685313e-01 8.4e+00 6.50e-01  3e-01  9e-01 77:47.4
  → Best P(x_target>0.0) = 0.685313, LB = 0.673514
   78    702 -6.906930930690693e-01 8.6e+00 6.75e-01  3e-01  1e+00 78:43.2
  → Best P(x_target>0.0) = 0.690693, LB = 0.679122
   79    711 -6.888531114688853e-01 8.5e+00 6.75e-01  3e-01  1e+00 79:39.9
  → Best P(x_target>0.0) = 0.688853, LB = 0.676450
   80    720 -6.855231447685524e-01 8.8e+00 6.72e-01  3e-01  1e+00 80:38.6
  → Best P(x_target>0.0) = 0.685523, LB = 0.673597
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
   81    729 -6.916430835691643e-01 9.5e+00 6.66e-01  3e-01  1e+00 81:35.9
  → Best P(x_target>0.0) = 0.691643, LB = 0.679247
   82    738 -6.938630613693864e-01 9.8e+00 7.01e-01  3e-01  1e+00 82:34.1
  → Best P(x_target>0.0) = 0.693863, LB = 0.681378
   83    747 -6.903030969690304e-01 9.8e+00 7.70e-01  4e-01  1e+00 83:30.5
  → Best P(x_target>0.0) = 0.690303, LB = 0.678883
   84    756 -6.881731182688173e-01 1.0e+01 8.79e-01  4e-01  1e+00 84:24.9
  → Best P(x_target>0.0) = 0.688173, LB = 0.676941
   85    765 -6.892131078689213e-01 1.2e+01 9.03e-01  4e-01  2e+00 85:20.4
  → Best P(x_target>0.0) = 0.689213, LB = 0.677578
   86    774 -6.891031089689104e-01 1.2e+01 9.03e-01  4e-01  2e+00 86:16.1
  → Best P(x_target>0.0) = 0.689103, LB = 0.677595
   87    783 -6.882131178688213e-01 1.2e+01 8.89e-01  4e-01  2e+00 87:09.8
  → Best P(x_target>0.0) = 0.688213, LB = 0.676251
   88    792 -6.889931100688993e-01 1.1e+01 8.70e-01  4e-01  2e+00 88:03.6
  → Best P(x_target>0.0) = 0.688993, LB = 0.676541
   89    801 -6.901630983690163e-01 1.1e+01 8.86e-01  4e-01  2e+00 89:01.8
  → Best P(x_target>0.0) = 0.690163, LB = 0.678617
   90    810 -6.928130718692813e-01 1.1e+01 8.46e-01  4e-01  1e+00 89:59.4
  → Best P(x_target>0.0) = 0.692813, LB = 0.679636
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
   91    819 -6.849031509684903e-01 1.1e+01 7.87e-01  4e-01  1e+00 90:54.2
  → Best P(x_target>0.0) = 0.684903, LB = 0.672913
   92    828 -6.983530164698353e-01 1.1e+01 7.79e-01  3e-01  1e+00 91:54.3
  → Best P(x_target>0.0) = 0.698353, LB = 0.685518
   93    837 -6.874431255687443e-01 1.1e+01 7.58e-01  3e-01  1e+00 92:59.1
  → Best P(x_target>0.0) = 0.687443, LB = 0.675768
   94    846 -6.902630973690264e-01 1.1e+01 8.34e-01  4e-01  1e+00 93:52.9
  → Best P(x_target>0.0) = 0.690263, LB = 0.678118
   95    855 -6.902430975690244e-01 1.1e+01 9.30e-01  4e-01  2e+00 94:47.6
  → Best P(x_target>0.0) = 0.690243, LB = 0.678653
   96    864 -6.935630643693563e-01 1.1e+01 9.97e-01  4e-01  2e+00 95:44.8
  → Best P(x_target>0.0) = 0.693563, LB = 0.681417
   97    873 -6.895431045689543e-01 1.3e+01 1.16e+00  5e-01  2e+00 96:38.7
  → Best P(x_target>0.0) = 0.689543, LB = 0.676951
   98    882 -6.862031379686203e-01 1.4e+01 1.13e+00  5e-01  2e+00 97:34.0
  → Best P(x_target>0.0) = 0.686203, LB = 0.674037
   99    891 -6.944530554694454e-01 1.5e+01 1.29e+00  6e-01  3e+00 98:28.2
  → Best P(x_target>0.0) = 0.694453, LB = 0.681833
  100    900 -6.853931460685393e-01 1.7e+01 1.38e+00  6e-01  3e+00 99:23.5
  → Best P(x_target>0.0) = 0.685393, LB = 0.674127

======================================================================
Optimization complete!
Best objective: 0.701733
Best lower bound: 0.687119
Best true P(x_3 > 0.0): 0.701733
Control penalty: 0.000000
======================================================================


Policy saved to: policy_cm1p0_act2_p2.npz
Alpha scaling parameters: [0.96063298]
Sensor mutual information: 4.059676 nats
